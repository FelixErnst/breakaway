<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Comparing samples visually with betta • breakaway</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script><script src="../pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="../index.html">breakaway</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="..//index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/breakaway.html">Get Started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/betta-figure.html">Comparing samples visually with betta</a>
    </li>
    <li>
      <a href="../articles/resample-estimates.html">Variance of alpha diversity estimates</a>
    </li>
    <li>
      <a href="../articles/sample-size-calculations.html">Sample size calculations for alpha diversity</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    <div class="page-header toc-ignore">
      <h1>Comparing samples visually with betta</h1>
                        <h4 class="author">Amy Willis</h4>
            
            <h4 class="date">2017-09-22</h4>
          </div>

    
    
<div class="contents">
<p><code>betta</code> is useful for formally testing differences between communities with respect to their alpha diversity. However, before ever doing any inferential test, it’s best to try to visualise the difference that you are looking for. Here is a example to show you how to do that using <code>betta_pic</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(breakaway)</code></pre></div>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">frequencytablelist &lt;-<span class="st"> </span><span class="kw">lapply</span>(<span class="kw">apply</span>(toy_otu_table, <span class="dv">2</span>, table), as.data.frame)
frequencytablelist &lt;-<span class="st"> </span><span class="kw">lapply</span>(frequencytablelist, function(x) x[x[,<span class="dv">1</span>]!=<span class="dv">0</span>,])

ob_results &lt;-<span class="st"> </span><span class="kw">lapply</span>(frequencytablelist[<span class="dv">1</span>:<span class="dv">15</span>], objective_bayes_negbin, <span class="dt">answers =</span> T, <span class="dt">plot=</span>F, <span class="dt">print =</span> F)

lower &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">lapply</span>(ob_results, function(x) x$results[<span class="st">"LCI.C"</span>, ]))
upper &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">lapply</span>(ob_results, function(x) x$results[<span class="st">"UCI.C"</span>, ]))
means &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">lapply</span>(ob_results, function(x) x$results[<span class="st">"mean.C"</span>, ]))
standard_deviations &lt;-<span class="st"> </span><span class="kw">unlist</span>(<span class="kw">lapply</span>(ob_results, function(x) x$results[<span class="st">"stddev.C"</span>, ]))

## Find how many otus are in the cyanobacteria genus
cyano_nodes &lt;-<span class="st"> </span><span class="kw">apply</span>(toy_otu_table[<span class="kw">grepl</span>(<span class="st">"Cyano"</span>, toy_taxonomy), ], <span class="dv">2</span>, function(x) <span class="kw">sum</span>(x&gt;<span class="dv">0</span>))
cyano_nodes &lt;-<span class="st"> </span>cyano_nodes

bloom1 &lt;-<span class="st"> </span>toy_metadata[, <span class="st">"bloom2"</span>]
bloom &lt;-<span class="st"> </span>bloom1 ==<span class="st"> "yes"</span></code></pre></div>
<p>The following is the default option for plotting. It shows the mean estimates with lines up to +/-2 standard deviations. In this way, it is a visual mimic of the procedure that underpins <code>betta</code>. Feel free to pull apart the source code to optimise it for your purposes. It uses base graphics.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="../reference/betta_pic.html">betta_pic</a></span>(means, standard_deviations, <span class="dt">mypch =</span> <span class="kw">ifelse</span>(bloom, <span class="dv">16</span>, <span class="dv">1</span>))</code></pre></div>
<p><img src="betta-figure_files/figure-html/unnamed-chunk-3-1.png" width="672"></p>
<p>The following is a nice option if you would like to use ggplot.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">require</span>(ggplot2)</code></pre></div>
<pre><code>## Loading required package: ggplot2</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">plot_data_frame &lt;-<span class="st"> </span><span class="kw">data.frame</span>(<span class="st">"index"</span> =<span class="st"> </span><span class="dv">1</span>:<span class="dv">15</span>, lower, upper, means, standard_deviations, <span class="st">"bloom"</span>=bloom[<span class="dv">1</span>:<span class="dv">15</span>])
plot_data_frame</code></pre></div>
<pre><code>##                index   lower   upper    means standard_deviations bloom
## Sample1.LCI.C      1 274.000 419.000 322.9580           37.678760 FALSE
## Sample2.LCI.C      2 312.000 618.025 383.8046           90.093470 FALSE
## Sample3.LCI.C      3 222.000 334.000 259.9260           30.859880 FALSE
## Sample4.LCI.C      4 231.000 573.025 339.7786           94.324590 FALSE
## Sample5.LCI.C      5 348.000 447.000 379.3778           23.714762 FALSE
## Sample6.LCI.C      6 365.000 431.000 387.8454           16.309933 FALSE
## Sample7.LCI.C      7 362.000 427.050 380.6788           17.211591  TRUE
## Sample8.LCI.C      8 397.000 430.000 410.1788            8.469143  TRUE
## Sample9.LCI.C      9 348.000 424.000 370.6660           18.807615 FALSE
## Sample10.LCI.C    10 321.975 433.000 361.9068           28.510122 FALSE
## Sample11.LCI.C    11 315.000 553.000 378.3776           60.556229 FALSE
## Sample12.LCI.C    12 371.000 439.000 396.9160           17.577336 FALSE
## Sample13.LCI.C    13 386.000 435.000 403.1800           13.081186 FALSE
## Sample14.LCI.C    14 375.000 418.000 390.1980           11.120267  TRUE
## Sample15.LCI.C    15 251.000 333.000 280.3178           21.746084  TRUE</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/ggplot">ggplot</a></span>(plot_data_frame, <span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> index, <span class="dt">y =</span> means, <span class="dt">col =</span> bloom)) +
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_segment">geom_segment</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> index, <span class="dt">xend =</span> index, <span class="dt">y =</span> lower, <span class="dt">yend =</span> upper, <span class="dt">col =</span> bloom), <span class="dt">lwd =</span> <span class="fl">1.25</span>) +
<span class="st">  </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/geom_point">geom_point</a></span>(<span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/aes">aes</a></span>(<span class="dt">x =</span> index, <span class="dt">y =</span> means)) +<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">xlab</a></span>(<span class="st">"Samples"</span>) +<span class="st"> </span><span class="kw"><a href="http://www.rdocumentation.org/packages/ggplot2/topics/labs">ylab</a></span>(<span class="st">"Richness estimates (Objective Bayes)"</span>)</code></pre></div>
<p><img src="betta-figure_files/figure-html/unnamed-chunk-4-1.png" width="672"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Amy Willis, Kathryn Barger, John Bunge.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
