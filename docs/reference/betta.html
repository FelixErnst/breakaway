<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html>
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Modelling total diversity with betta — betta • breakaway</title>

<!-- jquery -->
<script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://maxcdn.bootstrapcdn.com/bootswatch/3.3.7/united/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">

<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/1.7.1/clipboard.min.js" integrity="sha384-cV+rhyOuRHc9Ub/91rihWcGmMmCXDeksTtCihMupQHSsi8GIIRDG0ThDc3HGQFJ3" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../jquery.sticky-kit.min.js"></script>
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Modelling total diversity with betta — betta" />

<meta property="og:description" content="This function tests for heterogeneity of total diversity (observed plus
unobserved) across multiple sites. It can account or test for fixed effects
that may explain diversity. It returns the significance of the covariates in
explaining diversity and a hypothesis test for heterogeneity." />

<meta property="og:image" content="http://adw96.github.io/breakaway/logo.png" />
<meta name="twitter:card" content="summary" />


<!-- mathjax -->
<script src='https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML'></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">breakaway</a>
        <span class="label label-default" data-toggle="tooltip" data-placement="bottom" title="Released package">4.3</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/breakaway.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/alpha-better.html">alpha diversity, properly</a>
    </li>
    <li>
      <a href="../articles/betta-figure.html">Comparing samples visually with betta</a>
    </li>
    <li>
      <a href="../articles/extended-tutorial.html">Getting into the weeds</a>
    </li>
    <li>
      <a href="../articles/phyloseq.html">breakaway + phyloseq</a>
    </li>
    <li>
      <a href="../articles/resample-estimates.html">Variance of alpha diversity estimates</a>
    </li>
    <li>
      <a href="../articles/sample-size-calculations.html">Sample size calculations for alpha diversity</a>
    </li>
  </ul>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Modelling total diversity with betta</h1>
    
    <div class="hidden name"><code>betta.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function tests for heterogeneity of total diversity (observed plus
unobserved) across multiple sites. It can account or test for fixed effects
that may explain diversity. It returns the significance of the covariates in
explaining diversity and a hypothesis test for heterogeneity.</p>
    
    </div>

    <pre class="usage"><span class='fu'>betta</span>(<span class='no'>chats</span>, <span class='no'>ses</span>, <span class='kw'>X</span> <span class='kw'>=</span> <span class='fl'>NA</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>chats</th>
      <td><p>A vector of estimates of total diversity at different sampling
locations. <samp>breakaway</samp> estimates are suggested in the high-diversity
case but not enforced.</p></td>
    </tr>
    <tr>
      <th>ses</th>
      <td><p>The standard errors in <samp>chats</samp>, the diversity estimates.</p></td>
    </tr>
    <tr>
      <th>X</th>
      <td><p>A numeric matrix of covariates. If not supplied, an intercept-only
model will be fit.</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    

<dt>table</dt><dd><p>A coefficient table for the model parameters. The
columns give the parameter estimates, standard errors, and p-values,
respectively. This model is only as effective as your diversity estimation
procedure; for this reason please confirm that your estimates are
appropriate and that your model is not misspecified. <samp>betta_pic</samp> may be
useful for this purpose.</p></dd> <dt>cov</dt><dd><p>Estimated covariance matrix of the
parameter estimates.</p></dd> <dt>ssq_u</dt><dd><p>The estimate of the heterogeneity
variance.</p></dd> <dt>homogeneity</dt><dd><p>The test statistic and p-value for the test
of homogeneity.</p></dd> <dt>global</dt><dd><p>The test statistic and p-value for the
test of model explanatory power.</p></dd> <dt>blups</dt><dd><p>The conditional expected
values of the diversity estimates (conditional on the random effects). The
authors propose that if the practitioner believes that information from one
diversity estimator may inform the others, then using the <samp>condfits</samp> as
estimators of total diversity rather than <samp>Chats</samp> may reduce variance
of diversity estimates by ``sharing strength'' across the samples.</p></dd>
<dt>blupses</dt><dd><p>The estimated standard deviation (standard errors) in the
blups.</p></dd>

    
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>Ecologists who are interested in the way species richness varies with
covariate information often run a regression-type analysis on the observed
diversity using their covariate information as predictors. However, in many
settings (especially microbial), rare and unobserved taxa play a hugely
important role in explaining the subtleties of the ecosystem, however, a
regression analysis on the observed diversity level fails to account for
these unobserved taxa. By predicting the total level of diversity (for
example, via <code><a href='breakaway.html'>breakaway</a></code>) and estimating the standard error in
the estimate, one can take account of these unobserved, but important, taxa.
In order to account for the estimated nature of the response, a mixed model
approach is taken, whereby the varying levels of confidence in the estimates
contributes to a diagonal but heteroscedastic covariance matrix. Given
covariates constitute the fixed effects in the mixed model, and significance
of the random effect term ``sigsq_u'' reflects heterogeneity in the sample,
that is, variability that cannot be explained by only the covariates. The
authors believe this to be the first attempt at modelling total diversity in
a way that accounts for its estimated nature.</p>
    
    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Willis, A., Bunge, J., and Whitman, T. (2015). Inference for
changes in biodiversity. <em>arXiv preprint.</em></p>
<p>Willis, A. and Bunge, J. (2015). Estimating diversity via frequency ratios.
<em>Biometrics.</em></p>
    
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><code><a href='breakaway.html'>breakaway</a></code>; <code><a href='breakaway_nof1.html'>breakaway_nof1</a></code>;
<code><a href='betta_pic.html'>betta_pic</a></code>; <code><a href='apples.html'>apples</a></code></p></div>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'>




















<span class='fu'>betta</span>(<span class='fu'>c</span>(<span class='fl'>2000</span>, <span class='fl'>3000</span>, <span class='fl'>4000</span>, <span class='fl'>3000</span>), <span class='fu'>c</span>(<span class='fl'>100</span>, <span class='fl'>200</span>, <span class='fl'>150</span>, <span class='fl'>180</span>), <span class='fu'>cbind</span>(<span class='fl'>1</span>, <span class='fu'>c</span>(<span class='fl'>100</span>, <span class='fl'>150</span>, <span class='fl'>100</span>,
    <span class='fl'>50</span>)))</div><div class='output co'>#&gt; $table
#&gt;         Estimates Standard Errors p-values
#&gt; [1,] 2.995149e+03      416.145952        0
#&gt; [2,] 1.730997e-03        3.931275        1
#&gt; 
#&gt; $cov
#&gt;            [,1]        [,2]
#&gt; [1,] 1575149.61 -14038.4223
#&gt; [2,]  -14038.42    140.5715
#&gt; 
#&gt; $ssq_u
#&gt; [1] 666667.8
#&gt; 
#&gt; $homogeneity
#&gt; [1] 143.9291   0.0000
#&gt; 
#&gt; $global
#&gt; [1] 5.180787e+01 6.120660e-13
#&gt; 
#&gt; $blups
#&gt; [1] 2014.709 2999.740 3967.199 2999.779
#&gt; </div><div class='input'>
<span class='co'>## handles missing data</span>
<span class='fu'>betta</span>(<span class='fu'>c</span>(<span class='fl'>2000</span>, <span class='fl'>3000</span>, <span class='fl'>4000</span>, <span class='fl'>3000</span>), <span class='fu'>c</span>(<span class='fl'>100</span>, <span class='fl'>200</span>, <span class='fl'>150</span>, <span class='fl'>NA</span>))</div><div class='output co'>#&gt; $table
#&gt;      Estimates Standard Errors p-values
#&gt; [1,]      3000        584.2429        0
#&gt; 
#&gt; $cov
#&gt;          [,1]
#&gt; [1,] 341339.7
#&gt; 
#&gt; $ssq_u
#&gt; [1] 1e+06
#&gt; 
#&gt; $homogeneity
#&gt; [1] 144.4444   0.0000
#&gt; 
#&gt; $global
#&gt; [1] 26.36669  0.00000
#&gt; 
#&gt; $blups
#&gt; [1] 2009.901 3000.000 3977.995       NA
#&gt; </div><div class='input'>
<span class='co'>## A test for heterogeneity of apples diversity estimates vs butterfly estimates</span>
<span class='fu'>betta</span>(<span class='fu'>c</span>(<span class='fl'>1552</span>, <span class='fl'>1500</span>, <span class='fl'>884</span>), <span class='fu'>c</span>(<span class='fl'>305</span>, <span class='fl'>675</span>, <span class='fl'>205</span>), <span class='fu'>cbind</span>(<span class='fl'>1</span>, <span class='fu'>c</span>(<span class='fl'>0</span>, <span class='fl'>0</span>, <span class='fl'>1</span>)))</div><div class='output co'>#&gt; $table
#&gt;      Estimates Standard Errors p-values
#&gt; [1,]      1526        294.0600     0.00
#&gt; [2,]      -642        424.3689     0.13
#&gt; 
#&gt; $cov
#&gt;           [,1]      [,2]
#&gt; [1,]  166341.7 -166341.7
#&gt; [2,] -166341.7  346430.7
#&gt; 
#&gt; $ssq_u
#&gt; [1] 138064
#&gt; 
#&gt; $homogeneity
#&gt; [1] 0.008750509 0.925471271
#&gt; 
#&gt; $global
#&gt; [1] 1.833863e+01 1.849194e-05
#&gt; 
#&gt; $blups
#&gt; [1] 1541.534 1519.954  884.000
#&gt; </div><div class='input'>





















</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#note">Note</a></li>

      <li><a href="#references">References</a></li>

      <li><a href="#see-also">See also</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

    <h2>Author</h2>
    
Amy Willis

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Amy Willis, Kathryn Barger, John Bunge.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://pkgdown.r-lib.org/">pkgdown</a>.</p>
</div>

      </footer>
   </div>

  

  </body>
</html>

